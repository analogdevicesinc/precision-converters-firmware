<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>AD7124 Temperature Measure Firmware Application &#8212; Precision Converters Firmware  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8e8a900e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/style.min.css?v=95305861" />
    <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script defer="" src="../../../_static/app.umd.js?v=c93eadd1"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="AD7134 IIO Application" href="../ad7134_iio/ad7134_iio.html" />
    <link rel="prev" title="AD7124 IIO Application" href="../ad7124_iio/ad7124_iio.html" />
   
  
  <meta name="global_root" content="../../../../">
  <meta name="repo" content="precision-converters-firmware">
  


<style>
  body {
    
  }

  body.dark {
    
  }

  @media (prefers-color-scheme: dark) {
    body:not(.light) {
      
    }
  }
</style>
  </head><body>
  <div class="banner"></div>
  <input type="checkbox" id="input-show-toc">
  <input type="checkbox" id="input-show-localtoc">
  <input type="checkbox" id="input-show-repotoc">

  
  <div class="search-area">
    <form action="" method="get">
      <input type="text" name="q" aria-labelledby="search-documentation" value="" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="search" placeholder="Search"/>
      <button value="search" class="icon"></button>
      <span id="search-progress"></span>
    </form>
  </div>
  

  <header>
    <div id="left">
      <label id="show-sidebar" class="icon" for="input-show-toc" title="Show/hide index"></label>
    </div>
    <div id="right">
      <span>
        <a id="logo-org" href="https://analog.com"></a>
        <div class="vertical-divider"></div>
        <label id="show-repotoc" for="input-show-repotoc" title="Show/hide docs" tabindex="0">Docs</label>
        <a id="logo" href="../../../index.html">
          <div>Precision Converters Firmware</div>
        </a>
      </span>
      <span class="reverse">
        <label id="show-localtoc" class="icon" for="input-show-localtoc" title="Show/hide contents"></label>
      </span>
    </div>
  </header>


  <div class="repotoc-tree overlay">
    <root>
  <a href="../../../../documentation/index.html">System Level</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../testbenches/index.html">HDL Testbenches</a>
  <a href="../../../../pyadi-iio/index.html">Hardware Python Interfaces</a>
  <a href="../../../../libiio/index.html">libiio</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../index.html" class="current">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
  <a href="../../../../scopy/index.html">Scopy</a>
  <a href="../../../../doctools/index.html">Doctools</a>
</root>

  </div>
    <div class="localtoc">
      <div class="tocwrapper">
        <div>
          <div class="localtoc-header">On this page</div>
          <a id="scroll-up" href="#top-anchor" title="Back to top"></a>
        </div>
        <nav>
          <ul>
<li><a class="reference internal" href="#">AD7124 Temperature Measure Firmware Application</a><ul>
<li><a class="reference internal" href="#supported-hardware">Supported Hardware</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#useful-links">Useful Links</a></li>
<li><a class="reference internal" href="#hardware-connections">Hardware Connections</a></li>
<li><a class="reference internal" href="#jumper-settings">Jumper Settings</a></li>
<li><a class="reference internal" href="#communication-interface">Communication Interface</a></li>
<li><a class="reference internal" href="#build-guide">Build Guide</a><ul>
<li><a class="reference internal" href="#build-prerequisites">Build Prerequisites</a></li>
<li><a class="reference internal" href="#building-a-project">Building a project</a></li>
<li><a class="reference internal" href="#running-a-project">Running a project</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-firmware">Using Firmware</a></li>
<li><a class="reference internal" href="#multiple-rtd-2-3-4-wire-configurations">Multiple RTD (2/3/4-wire Configurations)</a></li>
<li><a class="reference internal" href="#multiple-thermocouple-configurations">Multiple Thermocouple Configurations</a></li>
<li><a class="reference internal" href="#multiple-ntc-thermistor-configurations">Multiple NTC Thermistor Configurations</a></li>
<li><a class="reference internal" href="#calibrating-3-wire-rtds">Calibrating 3-wire RTDs</a></li>
<li><a class="reference internal" href="#calibrating-adc-internal-and-system-calibration">Calibrating ADC (Internal and System Calibration)</a></li>
<li><a class="reference internal" href="#firmware-structure">Firmware Structure</a></li>
<li><a class="reference internal" href="#support">Support</a></li>
</ul>
</li>
</ul>

        </nav>
      </div>
    </div>

  
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
    <a id="no-logo" href="../../../index.html">
      Precision Converters Firmware
    </a><input id="input-switch-toc" type="checkbox">
<label id="show-repotoc" for="input-switch-toc">
All content
</label>
<label id="show-toc" for="input-switch-toc">
Content on this topic
</label>
<div class="repotoc-tree">
  <root>
  <a href="../../../../documentation/index.html">System Level</a>
  <a href="../../../../hdl/index.html">HDL</a>
  <a href="../../../../testbenches/index.html">HDL Testbenches</a>
  <a href="../../../../pyadi-iio/index.html">Hardware Python Interfaces</a>
  <a href="../../../../libiio/index.html">libiio</a>
  <a href="../../../../no-OS/index.html">no-OS</a>
  <a href="../../../index.html" class="current">Precision Converters Firmware</a>
  <a href="../../../../PrecisionToolbox/index.html">Precision Toolbox</a>
  <a href="../../../../scopy/index.html">Scopy</a>
  <a href="../../../../doctools/index.html">Doctools</a>
</root>

</div>
<div class="toc-tree">
  <html>
  <body><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../build/project_build.html">Build Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../code_style.html">Code Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing to PCFW Repository</a></li>
<li class="toctree-l1 current"><input class="toctree-collapse" type="checkbox" name="toctree-collapse-1" id="toctree-collapse-1" checked=""/><div class="collapse"><a class="reference internal" href="../index.html">Firmware Applications</a><label for="toctree-collapse-1"><div class="icon"></div></label></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ad2s1210_iio/ad2s1210_iio.html">AD2S1210 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad355xr_iio/ad355xr_iio.html">AD355XR IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad405x_iio/ad405x_iio.html">AD405x IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4130_iio/ad4130_iio.html">AD4130 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4170_iio/ad4170_iio.html">AD4170 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad4696_iio/ad4696_iio.html">AD4696 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad559xr_console/ad559xr_console.html">AD559XR Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad5754r_iio/ad5754r_iio.html">AD5754R/CN0586 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad579x_iio/ad579x_iio.html">AD579X IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad590_console/ad590_console.html">AD590 Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad5933_console/ad5933_console.html">AD5933 Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7124_console/ad7124_console.html">AD7124 Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7124_iio/ad7124_iio.html">AD7124 IIO Application</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">AD7124 Temperature Measure Firmware Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7134_iio/ad7134_iio.html">AD7134 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad717x_console/ad717x_console.html">AD717x / AD411x Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad717x_iio/ad717x_iio.html">AD717x / AD411x IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad719x_iio/ad719x_iio.html">AD719x IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad738x_iio/ad738x_iio.html">AD738x IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7606_iio/ad7606_iio.html">AD7606 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad7689_iio/ad7689_iio.html">AD7689 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad77681_iio/ad77681_iio.html">AD7768-1 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ad777x_iio/ad777x_iio.html">AD777x IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adt7420_console/adt7420_console.html">ADT7420 Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ltc268x_console/ltc268x_console.html">LTC268x Console Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ltc2672_iio/ltc2672_iio.html">LTC2672 IIO Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="../nanodac_console/nanodac_console.html">nanoDAC+ Console Application</a></li>
</ul>
</li>
</ul>
</body>
</html>

</div>
        </div>
      </div>

  <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper" id="top-anchor">
          <div class="body" role="main">
            
  <section id="ad7124-temperature-measure-firmware-application">
<h1>AD7124 Temperature Measure Firmware Application<a class="headerlink" href="#ad7124-temperature-measure-firmware-application" title="Link to this heading">#</a></h1>
<section id="supported-hardware">
<h2>Supported Hardware<a class="headerlink" href="#supported-hardware" title="Link to this heading">#</a></h2>
<p><strong>Supported Devices:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.analog.com/en/products/ad7124-8.html">AD7124-8</a></p></li>
<li><p><a class="reference external" href="https://www.analog.com/en/products/ad7124-4.html">AD7124-4</a></p></li>
</ul>
<p><strong>Supported Evaluation Boards:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-AD7124-8.html">EVAL-AD7124-8</a></p></li>
<li><p><a class="reference external" href="https://www.analog.com/en/design-center/evaluation-hardware-and-software/evaluation-boards-kits/EVAL-AD7124-4.html">EVAL-AD7124-4</a></p></li>
</ul>
<p><strong>Supported Carrier Boards:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://os.mbed.com/platforms/SDP_K1/">SDP-K1 With Mbed</a></p></li>
</ul>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This guide gives an overview of using the temperature measurement console firmware
application with Analog Devices AD7124 Evaluation board and SDP-K1 (or other compatible)
MCU controller board, leveraging Mbed-OS as a primary software platform.
The firmware application provides an user-interactive menu options for user to select
and configure the multiple temperature sensors at different instances, such as
2/3/4-wire RTDs, NTC Thermistors and Thermocouples.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_interface.png"><img alt="../../../_images/ad7124_interface.png" src="../../../_images/ad7124_interface.png" style="width: 600px;" />
</a>
</div></blockquote>
<p>The interface used for communicating with PC based console tools (e.g. Teraterm) is UART.
Firmware leverages the ADI created no-os and platform driver software layers
to communicates with ADC device.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code has been developed and tested on the SDP-K1 Controller Board with
Arduino headers. However, the same code can be used with minimal modifications
on any Mbed enabled board which has Arduino Header support on it. To find out
all supported Mbed boards, refer this link: <a class="reference external" href="https://os.mbed.com/platforms/">https://os.mbed.com/platforms/</a></p>
</div>
</section>
<section id="useful-links">
<h2>Useful Links<a class="headerlink" href="#useful-links" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/analogdevicesinc/precision-converters-firmware">Source Code: Precision Converters Firmware</a></p></li>
<li><p><a class="reference external" href="https://github.com/analogdevicesinc/no-OS">no-OS: Software drivers for systems without OS</a></p></li>
<li><p><a class="reference external" href="https://studio.keil.arm.com/auth/login/">Keil Studio Web IDE/Compiler</a></p></li>
<li><p><a class="reference external" href="https://os.mbed.com/platforms/SDP_K1/">SDP-K1 on Mbed</a></p></li>
<li><p><a class="reference external" href="https://github.com/analogdevicesinc/linux">Linux Drivers</a></p></li>
<li><p><a class="reference external" href="https://github.com/analogdevicesinc/hdl">HDL Source Code</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Linux and HDL are not used in emebdded IIO firmware projects but
they may be of interest if you require Linux and/or FPGA support.</p>
</div>
</section>
<section id="hardware-connections">
<h2>Hardware Connections<a class="headerlink" href="#hardware-connections" title="Link to this heading">#</a></h2>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_hardware_connections.png"><img alt="../../../_images/ad7124_hardware_connections.png" src="../../../_images/ad7124_hardware_connections.png" style="width: 800px;" />
</a>
</div></blockquote>
</section>
<section id="jumper-settings">
<h2>Jumper Settings<a class="headerlink" href="#jumper-settings" title="Link to this heading">#</a></h2>
<p><strong>SDP-K1:</strong></p>
<p>Connect the VIO_ADJUST jumper on the SDP-K1 board to 3.3V position to drive SDP-K1 GPIOs at 3.3V</p>
<p><strong>EVAL-AD7124:</strong></p>
<p>Refer user manual of required evaluation board.</p>
</section>
<section id="communication-interface">
<h2>Communication Interface<a class="headerlink" href="#communication-interface" title="Link to this heading">#</a></h2>
<p>SDP-K1 is powered through USB connection from the computer. SDP-K1 MCU board acts
as a serial device when connected to PC, which creates a serial ports to connect
to console based tool running on PC. The serial port assigned to a device can
be seen through the device manager for windows-based OS as shown below. Use UART
(physical) port for PC communication.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/serial_ports_view.png"><img alt="../../../_images/serial_ports_view.png" src="../../../_images/serial_ports_view.png" style="width: 400px;" />
</a>
</div></blockquote>
</section>
<section id="build-guide">
<h2>Build Guide<a class="headerlink" href="#build-guide" title="Link to this heading">#</a></h2>
<section id="build-prerequisites">
<h3>Build Prerequisites<a class="headerlink" href="#build-prerequisites" title="Link to this heading">#</a></h3>
<p>Prior to building a firmware project, it is required to set up an environment so
that the build process may find the necessary tools (compiler, linker, SDK etc.).
Use the following steps to prepare your environment for building firmware projects
for respective platform.</p>
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="d21ad2cb7a8b86eb27746a20544728dc233b644a" name="d21ad2cb7a8b86eb27746a20544728dc233b644a" type="checkbox"></input><label for="d21ad2cb7a8b86eb27746a20544728dc233b644a"><p>Windows</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="09fb7c01896ae766da2ee01308090388bae68d1b" name="09fb7c01896ae766da2ee01308090388bae68d1b" type="checkbox"></input><label for="09fb7c01896ae766da2ee01308090388bae68d1b"><p>Mbed</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="39f5f3bbb61ac4ff030ff90ba173d6b14ddaee72" name="39f5f3bbb61ac4ff030ff90ba173d6b14ddaee72" type="checkbox"></input><label for="39f5f3bbb61ac4ff030ff90ba173d6b14ddaee72"><p>For Web/Online Build</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul class="simple">
<li><p>Visit <a class="reference external" href="https://www.keil.arm.com/">Arm Keil website</a> to create an user account for accessing the web based Keil Studio IDE.</p></li>
<li><p>Open <a class="reference external" href="https://studio.keil.arm.com/auth/login/">Keil Studio Web IDE</a> with registered user account</p></li>
</ul>
</div>
</div>
</div><div><div class="collapsible docutils container">
<input class="collapsible_input" id="a16acbaf74415871cd32264793d63ec12b79936d" name="a16acbaf74415871cd32264793d63ec12b79936d" type="checkbox"></input><label for="a16acbaf74415871cd32264793d63ec12b79936d"><p>For Make Build</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul class="simple">
<li><p>Clone Precision Converters Firmware repository with the –recursive flag (not needed if building with web IDE for Mbed platform):</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--recursive<span class="w"> </span>https://github.com/analogdevicesinc/precision-converters-firmware
</pre></div>
</div>
<ul class="simple">
<li><p>If however you’ve already cloned the repository without the –recursive flag, you may initialize all the submodules in an existing cloned repo with:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--recursive<span class="w"> </span>--init
</pre></div>
</div>
<ul>
<li><p>Install <a class="reference external" href="https://gnuwin32.sourceforge.net/packages/make.htm">Make</a> in the root of ‘C’ drive without any spaces in the installation path. The path must be <strong>C:\GnuWin32\…</strong>. Add this path into the system environmental path variable (as shown in below screenshot).</p></li>
<li><p>Install <a class="reference external" href="https://git-scm.com/downloads">Git</a> and add a path of <strong>C:\Program Files\Git\usr\bin\</strong> directory into system environmental path variable (please verify your git installation path is correct).</p></li>
<li><p>Install Mbed CLI 1 as per guide <a class="reference external" href="https://os.mbed.com/docs/mbed-os/v6.15/build-tools/install-and-set-up.html">here</a>.</p></li>
<li><p>Install <a class="reference external" href="https://developer.arm.com/downloads/-/gnu-rm.">GNU Arm Embedded compiler</a> (for the development, 9-2019-q4-major version is used) and add a path of GNU Arm Embedded Toolchain bin directory into the system environmental path variable (as shown in below screenshot).</p></li>
<li><p>Configure the compiler location with Mbed CLI. This can be carried out by running the <strong>mbed config -G GCC_ARM_PATH &lt;path-to-your-gcc-compiler&gt;</strong> in Command Prompt. For example you can run <strong>mbed config -G GCC_ARM_PATH “C:\Program Files (x86)\GNU Tools ARM Embedded\9 2019-q4-major\bin”</strong> in command prompt. It will set mentioned compiler path to all the Mbed Projects.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/environmental_variables.png"><img alt="../../../_images/environmental_variables.png" src="../../../_images/environmental_variables.png" style="width: 400px;" />
</a>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div></div>
</div>
</div><div><div class="collapsible docutils container">
<input class="collapsible_input" id="fa09a7188e5b64e6db36c1092089233b09fd75ba" name="fa09a7188e5b64e6db36c1092089233b09fd75ba" type="checkbox"></input><label for="fa09a7188e5b64e6db36c1092089233b09fd75ba"><p>STM32</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="31dd6c13542299d944a089597884f96e3993de5c" name="31dd6c13542299d944a089597884f96e3993de5c" type="checkbox"></input><label for="31dd6c13542299d944a089597884f96e3993de5c"><p>For STM32 IDE based Build</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul>
<li><p>Install <a class="reference external" href="https://www.st.com/en/development-tools/stm32cubeide.html">STM32CubeIDE</a></p></li>
<li><p>Install <a class="reference external" href="https://www.st.com/en/development-tools/stm32cubemx.html">STM32CubeMX</a></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/environmental_variables.png"><img alt="../../../_images/environmental_variables.png" src="../../../_images/environmental_variables.png" style="width: 400px;" />
</a>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div></div>
</div>
</div></div>
</div>
</div></section>
<section id="building-a-project">
<h3>Building a project<a class="headerlink" href="#building-a-project" title="Link to this heading">#</a></h3>
<p>Once the build enviornment is setup, follow the guide below to build your project
and generate executable file (.bin/.hex)</p>
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="4e36d84c7a50755ee7cf6b38b7ce0c2fcb39378a" name="4e36d84c7a50755ee7cf6b38b7ce0c2fcb39378a" type="checkbox"></input><label for="4e36d84c7a50755ee7cf6b38b7ce0c2fcb39378a"><p>Windows</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="8a96b2f5ce328a338a212ed635951e2db86e0faa" name="8a96b2f5ce328a338a212ed635951e2db86e0faa" type="checkbox"></input><label for="8a96b2f5ce328a338a212ed635951e2db86e0faa"><p>Mbed</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="f2c48851e525d0a0dff128e83d63241bbb3850e3" name="f2c48851e525d0a0dff128e83d63241bbb3850e3" type="checkbox"></input><label for="f2c48851e525d0a0dff128e83d63241bbb3850e3"><p>Build Using Web/Online IDE</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul>
<li><p>Clone the <a class="reference external" href="https://github.com/analogdevicesinc/precision-converters-firmware">Precision Converters Firmware repository</a> into Keil Studio using “File-&gt;clone…” menu.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/mbed_keil_studio_project_clone.png"><img alt="../../../_images/mbed_keil_studio_project_clone.png" src="../../../_images/mbed_keil_studio_project_clone.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>Once the project repository is imported, wait until all library dependencies are imported as shown in below screenshot. Now, open the ‘.medignore’ file present in the root directory of repository. Add comment syntax (two forward slashes) in front of the project name which you want to build. This will ignore all other projects and build only the comment syntax selected project.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/mbedignore_changes.png"><img alt="../../../_images/mbedignore_changes.png" src="../../../_images/mbedignore_changes.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>Select the target device (default used for development is SDP-K1) and click on ‘Clean build’ option to build the project. After a successful build a binary will be downloaded to your computer- store this on your drive. Drag and drop this binary to the USB drive hosted by your controller board to flash the MCU.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/mbed_build.png"><img alt="../../../_images/mbed_build.png" src="../../../_images/mbed_build.png" style="width: 400px;" />
</a>
</div></blockquote>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you intend to build different project, then modify the .medignore file in the root directory as
mentioned in step2 and clean build project as mentioned in step3</p>
</div>
</div>
</div>
</div><div><div class="collapsible docutils container">
<input class="collapsible_input" id="392c4f82a53d51f38b7cc22de16957d050be656e" name="392c4f82a53d51f38b7cc22de16957d050be656e" type="checkbox"></input><label for="392c4f82a53d51f38b7cc22de16957d050be656e"><p>Build Using Make</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul class="simple">
<li><p>Open Git bash and change current directory to project directory (eg. <strong>precision-converters-firmware/projects/ad4130_iio</strong> directory) which you want to build.</p></li>
<li><p>Type <strong>make</strong> on the git bash command prompt to build a project.</p></li>
<li><p>After successful build, binary file will be created into the <strong>Project_Name/build</strong> directory.</p></li>
<li><p>If you want to clean build, type <strong>make reset</strong> on git bash command which deletes all generated build files for the given project.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default TARGET_BOARD is SDP_K1 and COMPILER is GCC_ARM. Current Make based build only support GCC_ARM Compiler.</p>
</div>
<ul class="simple">
<li><p>By default project is built for “SDP_K1” Board and “GCC_ARM” Compiler. If you want to build for other Mbed Board, For example If you want to build the project for “DISCO_F769NI” Board then run <strong>make TARGET_BOARD=DISCO_F769NI</strong> command in git bash command prompt. If you want to clean build, run <strong>make reset TARGET_BOARD=DISCO_F769NI</strong> command to delete the generated build files for the given project.</p></li>
</ul>
</div>
</div>
</div></div>
</div>
</div><div><div class="collapsible docutils container">
<input class="collapsible_input" id="6d4692d8c91dfb061dfba381ec4ebfcee15fe389" name="6d4692d8c91dfb061dfba381ec4ebfcee15fe389" type="checkbox"></input><label for="6d4692d8c91dfb061dfba381ec4ebfcee15fe389"><p>STM32</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<div><div class="collapsible docutils container">
<input class="collapsible_input" id="40d95710ac8c485fd38ee69527a9ba568f6db616" name="40d95710ac8c485fd38ee69527a9ba568f6db616" type="checkbox"></input><label for="40d95710ac8c485fd38ee69527a9ba568f6db616"><p>Build Using STM32 IDE</p>
<div class="icon"></div></label><div class="collapsible_content docutils container">
<ul>
<li><p>Open the respective project directory by navigating into the “precision_converters_firmware/projects/” folder.</p></li>
<li><p>In the “STM32” folder present within the project directory, double click and open the .ioc file present within.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_project_directory.png"><img alt="../../../_images/stm32_project_directory.png" src="../../../_images/stm32_project_directory.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>Click on the “Generate Code” option seen on the top right corner</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_generate_code.png"><img alt="../../../_images/stm32_generate_code.png" src="../../../_images/stm32_generate_code.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>Upon successful generation of drivers for the selected MCU, the autogenerated files would be seen in the same directory where the .ioc file was present. Double click and open the “.project” file seen in the list of files</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_auto_generated_files.png"><img alt="../../../_images/stm32_auto_generated_files.png" src="../../../_images/stm32_auto_generated_files.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>After the project is loaded to the STM32CubeIDE, unfold the adxxxx_iio project seen in the project explorer, right click the “app” folder, select “Settings” under the “C/C++ Build” section on the left pane and un-check the “Exclude resources from build” checkbox. This would ensure that the project specific files are included by the build system</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_exclude_files_option.png"><img alt="../../../_images/stm32_exclude_files_option.png" src="../../../_images/stm32_exclude_files_option.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>In order to choose STM32 platform in the firmware, select the “ACTIVE_PLATFORM” as “STM32_PLATFORM” in the app_config.h from the respective project. Alternately , add compiler flag “ACTIVE_PLATFORM=value of STM32_PLATFORM in app_config.h” for selecting stm32 platform.</p></li>
<li><p>Add compiler flags “-u _printf_float” to the project settings.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_compiler_flag.png"><img alt="../../../_images/stm32_compiler_flag.png" src="../../../_images/stm32_compiler_flag.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
<li><p>Program by clicking on the “Run adxxxx_iio” option seen or by performing a copy-&gt;paste option of the .hex file seen in the STM32/Debug folder</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/stm32_run_option.png"><img alt="../../../_images/stm32_run_option.png" src="../../../_images/stm32_run_option.png" style="width: 600px;" />
</a>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div></div>
</div>
</div></div>
</div>
</div></section>
<section id="running-a-project">
<h3>Running a project<a class="headerlink" href="#running-a-project" title="Link to this heading">#</a></h3>
<p>Once the firmware build is successful and binary file is generated, copy the
generated binary into USB drive hosted by your MCU board (e.g. USB drive hosted
by SDP-K1 board on windows). This will flash the binary file into MCU present
on the controller board. Programming might vary based on the tools used for building
a project. The ‘Project Build’ section above talks about this exception at the end
of all build steps.</p>
</section>
</section>
<section id="using-firmware">
<h2>Using Firmware<a class="headerlink" href="#using-firmware" title="Link to this heading">#</a></h2>
<p>Configure your serial terminal ( Tera Term) for below settings:</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/console_app_teraterm_settings.png"><img alt="../../../_images/console_app_teraterm_settings.png" src="../../../_images/console_app_teraterm_settings.png" style="width: 600px;" />
</a>
</div></blockquote>
<p>The AD7124 temperature measurement example main menu looks like below (with Tera Term):</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_temperature_measure_main_menu.png"><img alt="../../../_images/ad7124_temperature_measure_main_menu.png" src="../../../_images/ad7124_temperature_measure_main_menu.png" style="width: 600px;" />
</a>
</div></blockquote>
<p>Firmware allows user to perform the measurement for single or multiple (more than one)
temperature sensors of same type. Below sensors are supported:</p>
<ul class="simple">
<li><p>Single or Multiple 2/3/4-wire RTDs (default is PT100)</p></li>
<li><p>Single Or Multiple Thermocouple (default is T-type)</p></li>
<li><p>Single Or Multiple Thermistors (default is 10K NTC)</p></li>
</ul>
<p>User must ensure all sensors are connected to AD7124 evaluation board as per
configurations specific in the software and on this wiki page (see subsequent
sections). If user intend to change these configurations in the software, the
hardware connections must be modified as per new configurations. The details
about altering the software modules for modifying the configurations are given
in ‘Modifying Firmware’ section.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/bypassing_lk6_link_on_legacy_board.png"><img alt="../../../_images/bypassing_lk6_link_on_legacy_board.png" src="../../../_images/bypassing_lk6_link_on_legacy_board.png" style="width: 600px;" />
</a>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to use analog inputs AIN4 and AIN5 on Legacy AD7124 Eval board
(with SDP-120 interface only) in any of the demo mode, make sure to route the
sensor connections directly through LK6 link, instead of physical screw-terminal
connector. Make sure LK6 link is removed for the same purpose.</p>
</div>
</section>
<section id="multiple-rtd-2-3-4-wire-configurations">
<h2>Multiple RTD (2/3/4-wire Configurations)<a class="headerlink" href="#multiple-rtd-2-3-4-wire-configurations" title="Link to this heading">#</a></h2>
<p>Reference: <a class="reference external" href="https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/CN0383.html">https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/CN0383.html</a></p>
<p><strong>Multiple 2-wire RTD configurations:</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_multiple_2_wire_rtd_configs.png"><img alt="../../../_images/ad7124_multiple_2_wire_rtd_configs.png" src="../../../_images/ad7124_multiple_2_wire_rtd_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
<p><strong>Multiple 3-wire RTD configurations:</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_multiple_3_wire_rtd_configs.png"><img alt="../../../_images/ad7124_multiple_3_wire_rtd_configs.png" src="../../../_images/ad7124_multiple_3_wire_rtd_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
<p><strong>Multiple 4-wire RTD configurations:</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_multiple_4_wire_rtd_configs.png"><img alt="../../../_images/ad7124_multiple_4_wire_rtd_configs.png" src="../../../_images/ad7124_multiple_4_wire_rtd_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
</section>
<section id="multiple-thermocouple-configurations">
<h2>Multiple Thermocouple Configurations<a class="headerlink" href="#multiple-thermocouple-configurations" title="Link to this heading">#</a></h2>
<p>Reference: <a class="reference external" href="https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/CN0384.html">https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/CN0384.html</a></p>
<p><strong>Thermocouple (Hot Junction) configurations for TC measurement:</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_multiple_tc_configs.png"><img alt="../../../_images/ad7124_multiple_tc_configs.png" src="../../../_images/ad7124_multiple_tc_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
<p><strong>Cold Junction Compensation (CJC) configurations for TC measurement:</strong></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_cjc_configs.png"><img alt="../../../_images/ad7124_cjc_configs.png" src="../../../_images/ad7124_cjc_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
</section>
<section id="multiple-ntc-thermistor-configurations">
<h2>Multiple NTC Thermistor Configurations<a class="headerlink" href="#multiple-ntc-thermistor-configurations" title="Link to this heading">#</a></h2>
<p>Reference: <a class="reference external" href="https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/cn0545.html">https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/cn0545.html</a></p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_multiple_ntc10k_configs.png"><img alt="../../../_images/ad7124_multiple_ntc10k_configs.png" src="../../../_images/ad7124_multiple_ntc10k_configs.png" style="width: 800px;" />
</a>
</div></blockquote>
</section>
<section id="calibrating-3-wire-rtds">
<h2>Calibrating 3-wire RTDs<a class="headerlink" href="#calibrating-3-wire-rtds" title="Link to this heading">#</a></h2>
<p>Firmware provides an option for user to perform calibrated measurement on 3-wire
RTD sensors. There are two types of calibration options available in the firmware.
User must modify sensor hardware connections according to configuration defined
in the software. Based on selected calibration type, the sensors are first calibrated
and then 3-wire RTD measurement is performed on them. For more information on the
calibration scheme, refer the <a class="reference external" href="https://www.analog.com/en/design-center/reference-designs/circuits-from-the-lab/CN0383.html">design note</a>
on RTD measurement.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_3wire_rtd_calibration_menu.png"><img alt="../../../_images/ad7124_3wire_rtd_calibration_menu.png" src="../../../_images/ad7124_3wire_rtd_calibration_menu.png" style="width: 800px;" />
</a>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calibration is allowed to perform only on Multiple RTD sensors and not on a single RTD sensor.</p>
</div>
</section>
<section id="calibrating-adc-internal-and-system-calibration">
<h2>Calibrating ADC (Internal and System Calibration)<a class="headerlink" href="#calibrating-adc-internal-and-system-calibration" title="Link to this heading">#</a></h2>
<p>Firmware allows user to perform ADC calibration on the current sensor configuration
(demo mode) selected through console menu. ADC calibration helps to remove any offset
Or gain error present on the input channels. The updated device coefficients (gain and offset)
post ADC calibration are used/applied during the sensor measurement. Therefore,
once calibration is complete, user must go to the previous demo mode which was
selected before ADC calibration and then perform the measurement on selected sensors.
The calibration coefficients (gain and offset) are applied only on the analog input
channels which were enabled prior to calibration. Also after calibration if any
new demo mode is selected apart from the one which was enabled during calibration,
the calibration coefficients are reset and doesn’t applied on input channels. In
this case, user must perform the calibration again.</p>
<p>Internal ADC calibration is straightforward but system calibration needs user
inputs (typically after applying full-scale/zero-scale) voltages on selected
analog inputs.</p>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/ad7124_calibration_menu.png"><img alt="../../../_images/ad7124_calibration_menu.png" src="../../../_images/ad7124_calibration_menu.png" style="width: 800px;" />
</a>
</div></blockquote>
</section>
<section id="firmware-structure">
<h2>Firmware Structure<a class="headerlink" href="#firmware-structure" title="Link to this heading">#</a></h2>
<blockquote>
<div><a class="reference internal image-reference" href="../../../_images/firmware_architecture.png"><img alt="../../../_images/firmware_architecture.png" src="../../../_images/firmware_architecture.png" style="width: 600px;" />
</a>
</div></blockquote>
</section>
<section id="support">
<h2>Support<a class="headerlink" href="#support" title="Link to this heading">#</a></h2>
<p>Feel free to ask questions in the <a class="reference external" href="https://ez.analog.com/data_converters">EngineerZone</a></p>
</section>
</section>


          </div>
              <div class="related">
                &nbsp;
    <a href="../ad7124_iio/ad7124_iio.html" title="Previous document (Alt+Shift+LeftArrow)" class="prev">AD7124 IIO Application</a>
    <a href="../ad7134_iio/ad7134_iio.html" title="Next document (Alt+Shift+RightArrow)" class="next">AD7134 IIO Application</a>
              </div>
          
        </div>
      </div>
  </div>

  <div id="vertical-border"></div>

  <label id="cancel-area-show-toc" for="input-show-toc"></label>
  <label id="cancel-area-show-localtoc" for="input-show-localtoc"></label>
    <footer>
      &#169;2023-2024, Analog Devices Inc.
      
      |
      Made with <a href="https://www.sphinx-doc.org/">Sphinx</a>
      &amp; <a href="https://github.com/analogdevicesinc/doctools">Doctools</a>
      
    </footer>
  </body>
</html>